# 谨慎设计方法签名

本条款涉及到诸多API设计相关的内容，我们将这些内容放到一起来讲解。这有助于你编写出更易于学习、使用且不易出错的API。

**谨慎选择方法名**。名字应该总是遵循标准的命名约定（条款68）。你的首要目标应当是选择易于理解且与相同包下其他名字一致的名字。第二个目标则是选择与大众普遍认可的名字（如果有的话）相一致的名字。请避免使用过长的方法名。如果存疑，请查阅Java库APIs看一看。虽然有很多不一致的地方（考虑到这些库的大小与规模，这是不可避免的），不过还是有很多一致的地方。

**不要热衷于提供便捷方法。**。每个方法都应该『做好自己的分内之事』。过多的方法会使得类变得难以学习、使用、文档化、测试与维护。这一点对于接口来说更是如此，接口中过多的方法会让接口实现者和用户苦不堪言。对于类或是接口所支持的每个动作来说，请提供一个完整功能的方法。只有在方法经常被使用的情况下才考虑提供『简洁的』方法。**如果存疑，那就不要提供**。

**避免过长的参数列表**。至多提供4个参数或是更少一些。大多数程序员记不住太长的参数列表。如果很多方法都超过了这个限制，那就需要不停地查阅文档才能使用好API。虽然现代IDE可以在这一点上帮助到你，不过最好还是使用短一些的参数列表。同类型过长的参数列表危害更大。用户不仅记不住参数的顺序，而且当不小心调换了参数顺序时，程序依旧可以编译通过且运行起来。只不过程序的运行结果与编写者的意图不一样。

有3种做法可以缩短过长的参数列表。第1种是将一个方法分解为多个方法，分解后的每个方法只需要部分参数。如果不小心，那就会导致过多的方法，不过可以通过增加正交性来减少方法数量。比如说，考虑`java.util.List`接口。它并没有提供在子列表中寻找元素的第一个或是最后一个索引的方法，这两个方法都需要3个参数。相反，它提供了一个`subList`方法，该方法接收两个参数，并且返回一个子列表的视图。该方法可以与`indexOf`或是`lastIndexOf`方法组合起来，这两个方法都只有单个参数，这样就可以实现所需的功能了。此外，`subList`方法可以与任何对`List`实例进行操作的方法结合，从而完成对子列表的任意计算。这样，得到的API就拥有非常高的动力比了。

缩短过长参数列表的第2项技术是创建持有参数组合的辅助类。一般来说，这些辅助类都是静态成员类（条款24）。如果某个频繁出现的参数序列用于表示某个独一无二的实体，那就推荐使用该项技术。比如说，假设你正在编写一个表示某个纸牌游戏的类，你发现自己会频繁传递一个两参数序列（这两个参数分别表示纸牌的大小和花色）。如果添加一个辅助类来表示纸牌，并且使用该辅助类的实例作为单个参数来替换掉出现的每个参数序列，那么你的API以及类的内部实现都会从中获益。

第3项技术则部分组合了前两项技术，它从对象构建到方法调用都适配了构建器模式（条款2）。如果一个方法有很多参数，特别是其中一些参数还是可选的，那么我们就可以定义一个对象来表示所有的参数，并且让客户端对该对象进行多次『setter』调用，每次调用都会设置单个参数或是少量、相关联的参数组合。一旦设置好了所需的参数后，客户端就可以调用对象的『execute』方法，它可以对参数执行任何有效性检查，并执行实际的计算。

**对于参数类型来说，优先选择接口而非类**（条款64）。如果有恰当的接口可以定义参数，那就使用它而非实现了该接口的类。比如说，我们没理由编写一个接收`HashMap`作为输入的方法，请使用`Map`。这样，我们就可以传递`HashMap`、`TreeMap`、`ConcurrentHashMap`、`TreeMap`的子类，或是任何`Map`实现。如果使用类而非接口，那就会将客户端限制为特定的实现，如果输入数据碰巧是其他形式，那还得进行不必要且可能代价高昂的拷贝操作。

优先选择两元素的枚举类型而非`boolean`参数，除非从方法名来看，`boolean`的含义非常清晰。枚举会让代码变得更加易于读写。此外，后续添加更多选项也会变得更加轻松。比如说，有一个`Thermometer`类型，它有一个静态工厂会接收该枚举：

```
public enum TemperatureScale { FAHRENHEIT, CELSIUS }
```

 不仅`Thermometer.newInstance(TemperatureScale.CELSIUS)`要比`Thermometer.newInstance(true)`更加有意义，而且还可以在未来的版本中向`TemperatureScale`添加`KELVIN`而无需向`Thermometer`添加新的静态工厂。此外，你可以对枚举常量的方法重构温标依赖（条款34）。比如说，每个标度常量都可以拥有一个方法，它接收一个`double`值，并将其转换为摄氏度。