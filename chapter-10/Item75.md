# 在详细消息中包含失败捕获信息

当一个程序因为一个未捕获的异常而失败时，这个系统会自动打印出异常的堆栈信息。堆栈信息包含了异常的字符串表示，即调用异常的`toString`方法得到的结果。堆栈信息通常有异常的类名和它的详细信息组成。这通常是程序员或站点可靠性工程师在调查软件故障时所掌握的唯一信息。如果故障不容易重现，则可能很难或不可能获得更多的信息。因此，异常的`toString`方法应该尽可能地返回更多的关于失败原因的信息，这是非常重要的。换句话说，异常的详细信息应该捕获故障，以便进行后续分析。

**要捕获失败，异常的详细信息应该包含导致异常的所有参数和字段的值**。例如，`IndexOutOfBoundsException`的详细信息应该包含下界、上界和置于之间而失败的索引值。这个信息告诉我们很多关于失败的信息。这三个值中的任何一个或全部都可能是错误的。索引可能小于下界或等于上界，或者它可能是一个极端的值，过低或过高。下界可能大于上界（严重的内部不变失败）。每一种情况都指向一个不同的问题，如果你知道了正在查找的错误类型，就会大大有助于你问题的定位。

警告会涉及到安全敏感信息。因为堆栈信息可能被许多人在诊断和修复软件问题的过程中看到，所以不要包含密码、加密秘钥等类似信息。

虽然在异常的详细信息包含所有相关的数据是至关重要的，但通常不需要包含大量的不必要信息。堆栈信息的目的是结合文档一起分析，如果必要，还可以结合源码。它通常包含抛出异常的具体文件和行号，以及堆栈上所有方法调用所有其他方法调用的文件和行号。对失败的长篇描述是多余的;这些信息可以通过阅读文档和源代码来收集。

